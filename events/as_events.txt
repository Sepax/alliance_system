namespace = alliance_system
# Initialisation
country_event = {
	id = alliance_system.1
	title = alliance_system.1.t
	desc = alliance_system.1.d
	picture = RELIGION_eventPicture
	is_triggered_only = yes
	hidden = yes
	mean_time_to_happen = {
		days = 1
	}
	trigger = {
		always = yes
	}
	option = {
		country_event = {
			id = alliance_system.2
		}
		country_event = {
			id = alliance_system.3
		}
	}
}

# Sets dev values and finds the top dev country
country_event = {
	id = alliance_system.2
	title = alliance_system.2.t
	desc = alliance_system.2.d
	picture = RELIGION_eventPicture
	hidden = yes
	mean_time_to_happen = {
		days = 1
	}
	trigger = {
		NOT = {
			1269 = {
				has_province_modifier = dev_list_timer
			}
		}
	}
	option = {
		hidden_effect = {
			set_dev_values = yes
			find_top_dev = yes
		}
		1269 = {
			add_province_modifier = {
				name = dev_list_timer
				duration = 90
			}
		}
	}
}

# Updates the alliance points of all countries
country_event = {
	id = alliance_system.3
	title = alliance_system.3.t
	desc = alliance_system.3.d
	picture = RELIGION_eventPicture
	hidden = yes
	mean_time_to_happen = {
		days = 1
	}
	trigger = {
		ai = no
		NOT = {
			has_country_modifier = alliance_scanner_timer
		}
	}
	option = {
		hidden_effect = {
			alliance_scanner = yes
		}
		add_country_modifier = {
			name = alliance_scanner_timer
			duration = 30
			hidden = yes
		}
	}
}

# Too many alliances
country_event = {
	id = alliance_system.4
	title = alliance_system.4.t
	desc = alliance_system.4.d
	picture = RULEBREAK_eventPicture
	is_triggered_only = yes
	mean_time_to_happen = {
		days = 1
	}
	trigger = {
		ai = no
		has_country_flag = too_many_alliances
		NOT = {
			has_country_modifier = too_many_alliances_timer
		}
	}
	immediate {
		list_ally = {
			ally = A1
		}
		list_ally = {
			ally = A2
		}
		list_ally = {
			ally = A3
		}
		list_ally = {
			ally = A4
		}
		list_ally = {
			ally = A5
		}
		list_ally = {
			ally = A6
		}
		list_ally = {
			ally = A7
		}
		list_ally = {
			ally = A8
		}
		list_ally = {
			ally = A9
		}
		list_ally = {
			ally = A10
		}
		list_ally_clear = yes
	}
	option = {
		name = alliance_system.4.a
		trigger = {
			alliance_with = event_target:A1
		}
		break_alliance = event_target:A1
	}
	option = {
		name = alliance_system.4.b
		trigger = {
			alliance_with = event_target:A2
		}
		break_alliance = event_target:A2
	}
	option = {
		name = alliance_system.4.c
		trigger = {
			alliance_with = event_target:A3
		}
		break_alliance = event_target:A3
	}
	option = {
		name = alliance_system.4.d
		trigger = {
			alliance_with = event_target:A4
		}
		break_alliance = event_target:A4
	}
	option = {
		name = alliance_system.4.e
		trigger = {
			alliance_with = event_target:A5
		}
		break_alliance = event_target:A5
	}
	option = {
		name = alliance_system.4.f
		trigger = {
			alliance_with = event_target:A6
		}
		break_alliance = event_target:A6
	}
	option = {
		name = alliance_system.4.g
		trigger = {
			alliance_with = event_target:A7
		}
		break_alliance = event_target:A7
	}
	option = {
		name = alliance_system.4.h
		trigger = {
			alliance_with = event_target:A8
		}
		break_alliance = event_target:A8
	}
	option = {
		name = alliance_system.4.i
		trigger = {
			alliance_with = event_target:A9
		}
		break_alliance = event_target:A9
	}
	option = {
		name = alliance_system.4.j
		trigger = {
			alliance_with = event_target:A10
		}
		break_alliance = event_target:A10
	}
	option = {
		name = alliance_system.4.k
		trigger = {
			OR = {
				NOT = {
					num_of_allies = 1
				}
				all_ally = {
					ai = yes
				}
			}
		}
		every_country = {
			limit = {
				ai = no
				has_country_flag = alliance_notifications
				NOT = {
					tag = ROOT
				}
			}
			country_event = {
				id = alliance_system.5
			}
		}
	}
	after = {
		alliance_scanner = yes
		add_country_modifier = {
			name = too_many_alliances_timer
			duration = 90
			hidden = yes
		}
	}
}

# Too many alliances (notification)
country_event = {
	id = alliance_system.5
	title = alliance_system.5.t
	desc = alliance_system.5.d
	picture = southamericagfx_ANGRY_MOB_eventPicture
	is_triggered_only = yes
	trigger = {
		ai = no
		has_country_flag = alliance_notifications
	}
	option = {
		name = alliance_system.5.a
	}
}

country_event = {
	id = alliance_system.6
	title = alliance_system.6.t
	desc = alliance_system.6.d
	picture = RELIGION_eventPicture
	hidden = yes
	is_triggered_only = yes
	mean_time_to_happen = {
		days = 1
	}
	trigger = {
		ai = no
	}
	option = {
		clr_country_flag = alliance_system_notify_switch
	}
}


